<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paulo Villarroel">
<meta name="dcterms.date" content="2022-10-15">
<meta name="description" content="Uso datos abiertos de compras públicas para averiguar los proveedores top en tratos directos.">

<title>PauloVillarroel.com - ¿A quién le compra más el Estado?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-RNWVZS7ZL8"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-RNWVZS7ZL8', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>

<script src="../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.23/datatables.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PauloVillarroel.com</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">Sobre mí</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/paulovillarroel"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Chazkon"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/paulovillarroeltapia/"><i class="bi bi-linkedin" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">¿A quién le compra más el Estado?</h1>
                  <div>
        <div class="description">
          Uso datos abiertos de compras públicas para averiguar los proveedores top en tratos directos.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">tutorial</div>
                <div class="quarto-category">r</div>
                <div class="quarto-category">datos abiertos</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Paulo Villarroel </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 15, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#los-datos" id="toc-los-datos" class="nav-link active" data-scroll-target="#los-datos">Los datos</a></li>
  <li><a href="#análisis" id="toc-análisis" class="nav-link" data-scroll-target="#análisis">Análisis</a></li>
  <li><a href="#gráfico" id="toc-gráfico" class="nav-link" data-scroll-target="#gráfico">Gráfico</a></li>
  <li><a href="#finalmente" id="toc-finalmente" class="nav-link" data-scroll-target="#finalmente">Finalmente</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/paulovillarroel/mi_blog/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Hola!!</p>
<p>¿Te gustaría aprender a usar datos abiertos de compras públicas (Chile) y realizar este lindo gráfico?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="plot.png" class="img-fluid figure-img" width="800"></p>
</figure>
</div>
<p>Pues bueno, acá te enseño paso a paso.</p>
<p>Ah! No voy a realizar juicios de valor sobre los resultados. El fin de este artículo es mostrar una forma de usar datos abiertos y utilizando programación, realizar un breve análisis de consolidación de los datos y realizar el gráfico.</p>
<p>Dicho eso, pero sin dejar de mencionar que llama la atención los 3 primeros proveedores a los cuales se le ha comprado más jajaja 😂, vamos con el tema.</p>
<section id="los-datos" class="level2">
<h2 class="anchored" data-anchor-id="los-datos">Los datos</h2>
<p>El objetivo es investigar qué proveedores son los más top en adjudicarse órdenes de compra en salud.</p>
<p>Para ello, usaremos los datos abiertos disponibles en la <a href="https://datos-abiertos.chilecompra.cl/">plataforma de ChileCompra</a>.</p>
<p>Esta web es interesante, pues contiene los datos de todas las compras públicas desde hace muchos años hasta la fecha, que se han realizado por medio de <a href="https://www.mercadopublico.cl/Home">Mercado Público</a>. Por fines de investigación, siempre es una buena idea indagar en qué tipo de datos estás disponibles y cuales no. Además, de entender las distintas variables que contiene. Para eso, puedes revisar la <a href="https://datos-abiertos.chilecompra.cl/datos-abiertos">documentación</a> que el mismo sitio posee.</p>
<p>Ok. Partamos! 😎</p>
<p>Cargamos las librerias de R que usaremos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(archive)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vamos a utilizar la descripción que sale en la documentación sobre el uso de URL´s para la descarga de los archivos.</p>
<p>Existe la posibilidad de usar una API, pero requiere de un registro previo que no tengo, por lo cual no usaré esa opción. Sin embargo, esa sería la opción ideal para nuestro caso.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="urls.png" class="img-fluid figure-img" width="800"></p>
</figure>
</div>
<p>Basado en el ejemplo, como deseo descargar los datos de las órdenes de compra de salud habría que tener construir un link similar a <em>https://chc-oc-files.s3.amazonaws.com/sector/2020/Sem1/Salud.7z</em></p>
<p>Construyamos un pequeño loop para generar las URL´s necesarias para la descarga de los datos.</p>
<p>En la plataforma hay registros para los años 2007 al 2022, separados por semestres en cada caso. Pero para efectos de este artículo solo descargaré desde el año 2017 en adelante.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>total_url <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">2017</span><span class="sc">:</span><span class="dv">2022</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> year) {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  url_sem1 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://chc-oc-files.s3.amazonaws.com/sector/"</span>, i, <span class="st">"/Sem1/Salud.7z"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  url_sem2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://chc-oc-files.s3.amazonaws.com/sector/"</span>, i, <span class="st">"/Sem2/Salud.7z"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  total_url[[i]] <span class="ot">&lt;-</span> <span class="fu">c</span>(url_sem1, url_sem2)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Veamos las URL´s:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">unlist</span>(total_url, <span class="at">use.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>urls</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "https://chc-oc-files.s3.amazonaws.com/sector/2017/Sem1/Salud.7z"
 [2] "https://chc-oc-files.s3.amazonaws.com/sector/2017/Sem2/Salud.7z"
 [3] "https://chc-oc-files.s3.amazonaws.com/sector/2018/Sem1/Salud.7z"
 [4] "https://chc-oc-files.s3.amazonaws.com/sector/2018/Sem2/Salud.7z"
 [5] "https://chc-oc-files.s3.amazonaws.com/sector/2019/Sem1/Salud.7z"
 [6] "https://chc-oc-files.s3.amazonaws.com/sector/2019/Sem2/Salud.7z"
 [7] "https://chc-oc-files.s3.amazonaws.com/sector/2020/Sem1/Salud.7z"
 [8] "https://chc-oc-files.s3.amazonaws.com/sector/2020/Sem2/Salud.7z"
 [9] "https://chc-oc-files.s3.amazonaws.com/sector/2021/Sem1/Salud.7z"
[10] "https://chc-oc-files.s3.amazonaws.com/sector/2021/Sem2/Salud.7z"
[11] "https://chc-oc-files.s3.amazonaws.com/sector/2022/Sem1/Salud.7z"
[12] "https://chc-oc-files.s3.amazonaws.com/sector/2022/Sem2/Salud.7z"</code></pre>
</div>
</div>
<p>Muy bien!! Nos quedó genial!</p>
<p>Ahora nos toca descargar los archivos desde esas direcciones web.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(urls)) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  destfile <span class="ot">&lt;-</span> <span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">"/data/"</span>, i, <span class="st">".7z"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> urls[i]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(url, destfile, <span class="at">mode =</span> <span class="st">"wb"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Los archivos también pueden descargarse desde la misma plataforma sin necesidad de usar estas URL´s, sino que por medio de la <a href="https://datos-abiertos.chilecompra.cl/descargas/ordenes-y-licitaciones">propia interfaz</a> de Mercado Público. Sin embargo, me parece mejor idea el usar código para automatizar esas tareas para así evitar errores manuales y facilitar la descarga de nuevos archivos en un futuro.</p>
<p>Fíjate que los archivos vienen comprimidos en un formato 7z.</p>
<p>Si abrimos un archivo, nos encontraremos con otros 3 ó 4 en su interior:</p>
<ul>
<li><p>Convenio marco</p></li>
<li><p>Licitaciones</p></li>
<li><p>Trato directo</p></li>
<li><p>Compra ágil</p></li>
</ul>
<p>En mi caso, me interesa indagar en los tratos directos.</p>
<p>¿El motivo?</p>
<p>Me parecen más interesantes esos datos, puesto que hay gran variedad de compras y es en esta modalidad de compra en donde, muchas veces, se presta para fraude o problemas de legitimidad. Aunque con este artículo no pretendo realizar un análisis de ese estilo, podría ser de interés para alguien más y ocuparlo como base para fines de investigación.</p>
<p>A continuación realizaré algunos loops para automatizar la extracción de los datos.</p>
<p>Cabe mencionar que se podría hacer en menos lineas de código, pero prefiero dejarlo así para que te sea más simple de seguir el paso a paso.</p>
<p>Para la función de extracción (descomprimir) de más abajo, necesitamos ponerle nombres de los archivos 7z para pasárselo a la función <code>archive_extract()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>files_zipped <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(urls)) {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  file_name_zip <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"data/"</span>, i, <span class="st">".7z"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  files_zipped[[i]] <span class="ot">&lt;-</span> file_name_zip</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>files_zipped <span class="ot">&lt;-</span> <span class="fu">unlist</span>(files_zipped, <span class="at">use.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>files_zipped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "data/1.7z"  "data/2.7z"  "data/3.7z"  "data/4.7z"  "data/5.7z" 
 [6] "data/6.7z"  "data/7.7z"  "data/8.7z"  "data/9.7z"  "data/10.7z"
[11] "data/11.7z" "data/12.7z"</code></pre>
</div>
</div>
<p>Los archivos de los ultimos 2 años son diferentes a los anteriores y el nombre del archivo comprimido es distinto. Para resolver eso, implementé un <code>if()</code>, según qué archivo sea.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">i_am</span>(<span class="st">"index.qmd"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>oc <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> files_zipped) {</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">archive_extract</span>(<span class="at">archive =</span> i, <span class="at">dir =</span> <span class="st">"data"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"data/17TratoDirecto.csv"</span>)) {</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    oc[[i]] <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"data/17TratoDirecto.csv"</span>, <span class="at">encoding =</span> <span class="st">"Latin-1"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    oc[[i]] <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"data/17OCTratoDirecto.csv"</span>, <span class="at">encoding =</span> <span class="st">"Latin-1"</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora pasamos el objeto que nos habíamos creado a un <code>data.frame</code> y lo “aplanamos” para no tener problemas después con los análisis. Para lo último, usamos <code>unnest()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(oc) <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Veamos todas las variables que contiene el archivo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(all_data) <span class="co">#Filas y Columnas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1429423      44</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(all_data) <span class="co">#Nombre de variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "codigoOC"               "FechaEnvioOC"           "NombreOC"              
 [4] "DescripcionOC"          "EstadoOC"               "ProcedenciaOC"         
 [7] "MonedaOC"               "MontoNetoOC"            "DescuentosOC"          
[10] "CargosOC"               "ImpuestosOC"            "MontoTotalOC"          
[13] "ImpuestosOC_CLP"        "MontoNetoOC_CLP"        "MetodoPago"            
[16] "TipoDespacho"           "Financiamiento"         "UnidadCompra"          
[19] "UnidadCompraRUT"        "RegionUnidadCompra"     "entCode"               
[22] "Institucion"            "Sector"                 "Proveedor"             
[25] "ProveedorRUT"           "ActividadProveedor"     "TamanoProveedor"       
[28] "RegionProveedor"        "RubroN1"                "RubroN2"               
[31] "RubroN3"                "CodigoProductoONU"      "ONUProducto"           
[34] "NombreItem"             "DescripcionItem"        "CantidadItem"          
[37] "UnidadMedida"           "MonedaItem"             "MontoNetoItem"         
[40] "DescuentoItem"          "CargosItem"             "ImpuestoEspecificoItem"
[43] "MontoTotalItem"         "MontoNetoItemCLP"      </code></pre>
</div>
</div>
<p><strong>Importante</strong></p>
<p>Los archivos descargados son grandes y cuando se descrompimen, los son mucho más! Algunos llegan a pesar más de 200 o 300 Mb. De hecho, el objeto con todos los datos combinados sobrepasa 1 GB y tiene casi 1 millón y medio de filas. Con un Excel no podrás abrirlo, pues supera su límite. Por eso es importante usar programación. Otra instancia sería levantar un servidor SQL y cargar los datos, pero me parece que no vale la pena paa estos efectos.</p>
<p>Como los archivos descargados son bastante grandes, es mejor borrarlos, pues ya tenemos lo que necesitamos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/*"</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="análisis" class="level2">
<h2 class="anchored" data-anchor-id="análisis">Análisis</h2>
<p>Voy a considerar sólo las órdenes de compra (OC) en estados de <strong>recepción conforme</strong> y <strong>aceptadas</strong>. Esta es una decisión que tomé en base a lo que se menciona en el portal, en especial, a los <a href="https://desarrolladores.mercadopublico.cl/ocds/descripcion">estándares OCDS</a>.</p>
<p>Estos estándares permiten tener un lenguaje común sobre el estado de las OC y un formato estructurado que facilite la revisión, comprensión y consumo de los datos.</p>
<p>La decisión de usar solo esas etapas es más que nada para sacar del análisis todas aquellas OC que fueron rechazadas, tienen observaciones o sufrieron modificaciones en el camino. La idea es dejar aquellas efectivamente ejecutadas o que si bien aún no ocurren, ya fueron aceptadas por las partes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ocds.png" class="img-fluid figure-img" width="800"></p>
</figure>
</div>
<p>Algo que me parece interesante de observar, es el gasto asociado a esas OC durante los años analizados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>suppliers <span class="ot">&lt;-</span> all_data <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EstadoOC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Recepcion Conforme"</span>, <span class="st">"Aceptada"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(FechaEnvioOC, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Fecha"</span>, <span class="st">"Hora"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fecha =</span> <span class="fu">dmy</span>(Fecha)) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Proveedor, <span class="at">year =</span> <span class="fu">year</span>(Fecha)) <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mount =</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(MontoTotalItem), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>suppliers <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mount =</span> <span class="fu">sum</span>(mount, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, mount)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2017</span>, <span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>, <span class="dv">2021</span>, <span class="dv">2022</span>)) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Año"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Monto Total OC ($)"</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Vemos que en los años 2022 y 2021 los montos asociados a este tipo de OC aumentario de forma considerable respecto de los años anteriores. Posiblemente, eso tenga mucha relación con la pandemia y la necesidad de contar rápidamente con insumos, medicamentos, infraestructura, personal, exámenes y muchas otras cosas.</p>
<p>Si vemos los proveedores, podemos hace un ránking de éstos y revisar cuáles fueron los 5 de cada año que tuvieron mayores cantidades de transacciones por OC:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>top5_by_year <span class="ot">&lt;-</span> suppliers <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proveedor =</span> <span class="fu">str_to_upper</span>(Proveedor)) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mount)) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="fu">head</span>(., <span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>top5_by_year <span class="sc">|&gt;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-60be6cc602097fbd753d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-60be6cc602097fbd753d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],["ROCHE CHILE LIMITADA","INDUSTRIAS PRODUCTOS ALIMENTICIOS SA","GLAXOSMITHKLINE CHILE FARMACEUTICA LIMITADA","BRISTOL MYERS SQUIBB DE CHILE AGENC DE E R SQUIBB &amp; SONS INTERAM CORPO","MERCK SHARP &amp; DOHME (I.A) LLC,AGENCIA EN CHILE","GLAXOSMITHKLINE CHILE FARMACEUTICA LIMITADA","ROCHE CHILE LIMITADA","JOHNSON Y JOHNSON DE CHILE S A","MERCK SHARP &amp; DOHME (I.A) LLC,AGENCIA EN CHILE","GADOR LIMITADA","LABORATORIOS WYETH LLC","MERCK SHARP &amp; DOHME (I.A) LLC,AGENCIA EN CHILE","PFIZER CHILE S.A.","GLAXOSMITHKLINE CHILE FARMACEUTICA LIMITADA","ROCHE CHILE LIMITADA","ROCHE CHILE LIMITADA","GADOR LIMITADA","ABBVIE PRODUCTOS FARMACEUTICOS LIMITADA","JOHNSON Y JOHNSON DE CHILE S A","BRISTOL MYERS SQUIBB DE CHILE AGENC DE E R SQUIBB &amp; SONS INTERAM CORPO","ROCHE CHILE LIMITADA","DISTRIBUIDORA COMERCIAL PHARMASAN LIMITADA","PONTIFICIA UNIVERSIDAD CATOLICA DE CHILE","JOHNSON Y JOHNSON DE CHILE S A","LIFE TECHNOLOGIES CHILE SPA","ROCHE CHILE LIMITADA","PONTIFICIA UNIVERSIDAD CATOLICA DE CHILE","JOHNSON Y JOHNSON DE CHILE S A","TAAG GENETICS S A","ABBVIE PRODUCTOS FARMACEUTICOS LIMITADA"],[2017,2017,2017,2017,2017,2018,2018,2018,2018,2018,2019,2019,2019,2019,2019,2020,2020,2020,2020,2020,2021,2021,2021,2021,2021,2022,2022,2022,2022,2022],[23472392330,12580689400,11094784057,11089615855,10378399603,43946033497,37337502964,21405586200,21305849074,16744909040,25633073604,23353789302,18223404173,17686761539,17569893778,68286503812,35373547142,34809477443,24461850251,22741202358,71001268998,47751190300,24302057844,22314550472,21635827237,30693294568,22647393719,21942469022,21249113297,18497016066]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Proveedor<\/th>\n      <th>year<\/th>\n      <th>mount<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Si tienes interés en profundizar en el tema, ya tienes todo lo necesario. Tienes los datos y el código para replicarlo. Puedes seguir investigando los registros, de seguro hay cosas entretenidas. Quizás quieras dirigir el análisis a un proveedor en específico o a una institución pública en especial. La verdad, no hay límites. Solo tu curiosidad e imaginación.</p>
</section>
<section id="gráfico" class="level2">
<h2 class="anchored" data-anchor-id="gráfico">Gráfico</h2>
<p>Podemos graficarlo para ver mejor esos datos y analizar el comportamiento a lo largo de los años de los proveedores con más montos en OC.</p>
<p>Para eso usaremos la famosa libreria <code>ggplot2</code> con algunos agregados para hacer el gráfico más atractivo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> top5_by_year <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proveedor =</span> <span class="fu">fct_reorder</span>(Proveedor, mount, <span class="at">.fun =</span> <span class="st">"sum"</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mount_mill =</span> mount<span class="sc">/</span><span class="fl">1e6</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Proveedor, mount_mill, <span class="at">fill =</span> <span class="fu">factor</span>(year))) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>( <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">250000</span>)) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Compras públicas por trato directo en el sector salud"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Se consideran las OC con estados de recepción conforme y aceptadas"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Millones de pesos ($)"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Año"</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Fuente: ChileCompra (https://datos-abiertos.chilecompra.cl)</span><span class="sc">\n</span><span class="st">Elaborado por Paulo Villarroel"</span>) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>(<span class="at">grid =</span> <span class="st">"XY"</span>) <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="plot.png" class="img-fluid figure-img" width="800"></p>
</figure>
</div>
<p>Si quieres ver la imagen más grande, dale al boton derecho y abrir en nueva ventena.</p>
<p>Si, Si. Es el mismo gráfico del inicio 🥰</p>
<p>Listo!!</p>
</section>
<section id="finalmente" class="level2">
<h2 class="anchored" data-anchor-id="finalmente">Finalmente</h2>
<p>Espero que te haya gustado este artículo. Traté de ser lo más explicativo posible. Además, de dejarte el paso a paso para que tu sigas adelante.</p>
<p>Los datos abiertos son una muy buena oportunidad para que la ciudadanía pueda realizar fiscalización y auditoria al funcionamiento de los organismos públicos. Eso si, se requiere de ciertos conocimientos para saber dónde encontrar esos datos y para poder analizarlos. Es mi deseo que este artículo te sea de ayuda, despierte tu curiosidad y seamos agentes de divulgación científica de cara a la gente.</p>
<p>Nos vemos!!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/www\.paulovillarroel\.com\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<script src="https://giscus.app/client.js" data-repo="paulovillarroel/mi_blog" data-repo-id="R_kgDOH_9CVg" data-category="General" data-category-id="DIC_kwDOH_9CVs4CRgbc" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>