---
title: "Usa la inteligencia artificial en tu hoja de c√°lculo"
description: "Las hojas de c√°lculo las usamos en casi todo y para todo. En este art√≠culo te explico c√≥mo integrarlos, utilizando algoritmos de Google para predicci√≥n."
author: "Paulo Villarroel"
date: "2022-12-24"
categories: [tutorial, machine learning]
image: "ml-sheets.jpg"
---

Hola!

Bienvenido/a por estos lados. Si ya has le√≠do post anteriores, muchas gracias por volver. Si es tu primera, espero que te sea √∫til e interesante.

Hoy te traigo un tutorial que creo te va a interesar... usaremos modelos de inteligencia artificial de aprendizaje supervisado para predecir algunas cosas.

Pero...

Usando una hoja de c√°lculo de Google. Si, ese que se parece a Excel. Y solo con unos clics.

Te sorprender√°s! Ser√°s capaz de usar por ti mismo/a un modelo de inteligencia artificial con tus datos e increiblemente simple. Sigue leyendo. Te voy a explicar paso a paso c√≥mo usarlo y, a grandes rasgos, c√≥mo interpretarlo.

## ¬øQu√© es la inteligencia artificial?

La inteligencia artificial (IA) es una tecnolog√≠a que permite a las m√°quinas imitar el comportamiento inteligente de los humanos. Esto significa que las m√°quinas con IA pueden hacer cosas que normalmente requerir√≠an inteligencia humana, como reconocer patrones, aprender de experiencias pasadas y tomar decisiones basadas en informaci√≥n.

Hay diferentes tipos de IA, pero en general, todos trabajan utilizando algoritmos y datos para "ense√±ar" a las m√°quinas a hacer cosas de manera m√°s eficiente y precisa. Por ejemplo, una m√°quina con IA puede analizar grandes cantidades de informaci√≥n m√©dica para ayudar a los m√©dicos a diagnosticar enfermedades, o puede ayudar a una empresa a predecir qu√© productos ser√°n m√°s populares en el futuro.

La IA es una tecnolog√≠a muy √∫til y puede ayudarnos a hacer muchas cosas m√°s eficientes y r√°pidas, pero tambi√©n es importante recordar que es solo una herramienta y no puede reemplazar completamente a la inteligencia humana. Adem√°s, es importante utilizar la IA de manera responsable y √©tica para asegurarnos de que est√° beneficiando a la humanidad en lugar de causar problemas.

En el campo de la inteligencia artificial (IA), existen diferentes tipos de aprendizaje autom√°tico. Algunos de los tipos m√°s comunes incluyen:

1.  Aprendizaje supervisado.

2.  Aprendizaje no supervisado.

3.  Aprendizaje por refuerzo.

El modelo de IA que vamos a usar en este tutorial es de **aprendizaje supervisado.**

El aprendizaje supervisado es un tipo de aprendizaje autom√°tico en el que una m√°quina o modelo de aprendizaje autom√°tico es entrenado con un conjunto de datos etiquetados previamente. Los datos etiquetados incluyen un conjunto de entradas (tambi√©n conocidas como caracter√≠sticas) y una etiqueta de salida (tambi√©n conocida como la clase o el objetivo). La m√°quina utiliza estos datos para aprender a predecir la etiqueta de salida para nuevas entradas.

Por ejemplo, si estamos entrenando un modelo de aprendizaje autom√°tico para reconocer rostros, podr√≠amos proporcionarle un conjunto de im√°genes de rostros etiquetadas con el nombre de la persona en cada imagen. El modelo utilizar√≠a estos datos para aprender a reconocer rostros y predecir el nombre de la persona en nuevas im√°genes.

El aprendizaje supervisado es un tipo de aprendizaje autom√°tico muy com√∫n y es utilizado en una amplia variedad de aplicaciones, como la clasificaci√≥n de correos electr√≥nicos como spam o no spam, la detecci√≥n de fraudes en transacciones financieras y la predicci√≥n del precio de una propiedad. Es una forma efectiva de aprender a partir de datos etiquetados, pero requiere un conjunto de datos etiquetado previamente y puede no ser tan efectivo cuando el conjunto de datos no est√° bien equilibrado o no est√° completamente limpio.

Ok... Ya con estos conceptos generales en mente, avancemos en el tema. Iremos paso a paso.

Para efectos de demostraci√≥n, usar√© los mismos datos de ejemplo que proporciona Google. Ah! Lo mencion√©, pero no lo expliqu√©. Usarmos [TensorFlow de Google](https://www.tensorflow.org/).

## 
¬øQu√© es TensorFlow?

TensorFlow es una biblioteca de software de c√≥digo abierto para el aprendizaje autom√°tico y el c√°lculo num√©rico. Fue desarrollada por Google y se utiliza ampliamente en la industria y en la investigaci√≥n para construir y entrenar modelos de aprendizaje autom√°tico.

Es muy flexible y se puede utilizar para construir y entrenar una amplia variedad de modelos de aprendizaje autom√°tico, desde redes neuronales simples hasta modelos m√°s complejos como redes neuronales profundas. Tambi√©n es muy escalable y se puede utilizar en una amplia gama de plataformas, desde computadoras personales hasta servidores de alta escala y dispositivos m√≥viles.

TensorFlow es ampliamente utilizado en muchas √°reas, como la visi√≥n por computadora, el procesamiento del lenguaje natural, la detecci√≥n de fraudes y la predicci√≥n del precio de las acciones. Es una de las bibliotecas de aprendizaje autom√°tico m√°s populares y ampliamente utilizadas en la industria y en la investigaci√≥n.

Perfecto.

## Instalar plugin

Para los efectos del tutorial, debemos instalar una extensi√≥n de Google Sheets para poder usar TensorFlow en ella. Para eso, tenemos que ir al [Marketplace de Google](https://workspace.google.com/marketplace/app/simple_ml_for_sheets/685936641092) e instalar el plugin Simple ML for Sheets.

![](plugin.jpg){fig-align="center" width="800"}

Bueno, no lo mencion√©, pero debes tener una cuenta de Google y haber iniciado la sesi√≥n antes de instalar este plugin.

## Veamos los datos

Usaremos los datos que nos proporciona Google.

Anda a [este link](https://docs.google.com/spreadsheets/d/1Ve7umK4W6wBje1QZQVbPIH3djCl2uwfwXvezGliCpss/copy) y c√≥piate la plantilla de Google Sheets.

![](copia-sheets.jpg){fig-align="center" width="800"}

Esta plantilla tiene 4 datasets o conjuntos de datos precargados. Para nuestro tutorial, usaremos el de lo ping√ºinos, que es el caso 1. Este sirve para mostrar el uso de TensorFLow para completar los datos faltantes aplicando algunos modelos de predicci√≥n.

Los datos mostrados corresponden a una serie de mediciones de los ping√ºinos como el largo del pico, peso, largo de sus aletas y sexo. Esto, para 3 tipos de especies de ping√∫inos de la Ant√°rtica: Chinstrap, Gentoo y Adelie.

Seguramente si ya tienes algo de experiencia en programaci√≥n, este dataset te suene. Pues si, es uno de los cl√°sicos que se usa para ense√±ar distintos modelos de ML.

![](dataset.jpg){width="800"}

Ok. Con el plugin ya instalado y los datos ya disponibles, veamos algo...

F√≠jate que las primeras 30 filas no contiene datos de la especie del ping√ºino. Esos espacios en blanco (o datos faltantes) son los que por medio de un modelo de ML trataremos de predecir cu√°l deber√≠a ir en cada caso.

## Hagamos la predicci√≥n 

![](extension1.jpg){fig-align="center" width="800"}

En la pesta√±a de arriba, vamos a `Extensiones`, luego a `Simple ML for Sheets` y hacemos clic en `Start`.

Se abrir√° una peque√±a ventana a la derecha de la planilla.

![](predict.jpg){fig-align="center" width="300"}

F√≠jate en un par de cosas...

Haremos una predicci√≥n de los datos faltantes. Si haces clic en el listado te saldr√°n varias opciones. Por ahora usaremos la primera: `Predict missing values`.

![](predict2.jpg){fig-align="center" width="300"}

Luego, nos aseguramos que la columna indicada es la de `Species`, que es donde est√°n los datos vac√≠os.

En la parte de `Souce columns` podemos ver el tipo de datos de cada columna del set de datos.

![](types.jpg){fig-align="center" width="300"}

`Cat` corresponde a datos categ√≥ricos y `Num` a datos num√©ricos.

Nuestros datos a predecir son categ√≥ricos. Este detalle es importante a la hora de dise√±ar modelos de aprendizaje autom√°ticos, pero eso se escapa de este tutorial, as√≠ que no lo veremos ac√° por ahora.

En la siguiente opci√≥n podemos especificar el modeloo algoritmo de ML que usaremos. Para este tutorial vamos a usar un `Decision Tree`.

![](algorithm.jpg){fig-align="center" width="300"}

Usaremos ese modelo, pues es uno de los m√°s simples de entender, es f√°cil de graficar y de explicar. Tiene limitaciones y muchas veces hay modelos m√°s √∫tiles y con mejor desempe√±o, pero para partir est√° ok.

Una vez ya seleccionadas todas esas opciones, apreta el bot√≥n **Predict**.

Luego de unos segundos, en la plantilla se van crear 2 columnas: una con los valores de la predicci√≥n (donde est√°n vacios) y otra con un porcentaje (llamada `Pred:Conf.species`). Esta columna indica qu√© tan "seguro" est√° el modelo sobre el predicciones en la columna **Pred:species**. Este valor va de 0% a 100%. Como este es un modelo de clasificaci√≥n, esta m√©trica corresponde al *Accuracy*.

![](accuracy.jpg){fig-align="center" width="300"}

A continuaci√≥n te muestro los valores que me arrojaron a mi. Ojo, que esas cifras podr√≠an variar en tu caso.

![](dataset2.jpg){width="800"}

Nota que a√∫n cuando el modelo que usamos en de los m√°s simples, sus resultados son bastante buenos.

Un detalle relevante es que esa capacidad de predicci√≥n y *accuracy* se basa en los datos de entrenamiento. Es decir, el modelo se entrena con un determinado numero de datos y luego aplica el modelo sobre dato que no ha visto. Para ello, hay diversas t√©cnicas para mejorar el poder predictivo de los algoritmos y es, tambi√©n, uno de los pasos m√°s importantes en el dise√±o e implementaci√≥n de modelos de ML. Hay, adem√°s, modelos pre-entrenados. Es decir, que alguien ya los entren√≥, habotualmente con miles o millones de datos y que los puedes usar con determinados ajustes. Pero de eso, no hablaremos ahora.

## Explicando el modelo

Ya, ok. Todo muy lindo. Pero esto parece magia. O sea, selecciono un par de cosas, apreto un bot√≥n y me dice los valores que faltan.

Bueno, eso es algo que no debe pasar o que de alguna forma, debemos reducir. La caja negra que est√° detr√°s de los modelos de ML puede ser muy simple de entender o imposible definitivamente. El tema de la **explicabilidad y transparencia algor√≠tmica** es un √°rea de estudio muy relevante en el uso √©tico de datos, m√°s a√∫n cuando cada d√≠a m√°s el uso de IA est√° m√°s extenso y de f√°cil acceso.

Este es un tutorial nada m√°s, pero todo este tema es algo que jam√°s debemos pasar por alto. Mucho menos en salud o en la toma de decisiones de pol√≠tica p√∫blica. Dicho eso, sigamos...

El plugin de TensorFlow tiene algunas opciones para explicar el modelo y sus resultados. \
A ver, no es tan configurable como uno podr√≠a hacerlo programando el modelo, pero me parece interesante que incluya este tipo de cosas.

Veamos...

En la primera parte, ahora seleccionamos `Understand a model`:

![](predict3.jpg){fig-align="center" width="300"}

Luego, en la secci√≥n de Model, elegimos el modelo para "explicar". Los modelos se guardan con la fecha y hora en que fueron ejecutadoscpor defecto. Si es el primero que haces, bueno, solo tendr√°s 1 opci√≥n para seleccionar. Si has hecho varias, f√≠jate bien cu√°l seleccionas.

Hay una opci√≥n de cambiar el nombre al modelo para que se m√°s simple saber cu√°l es cu√°l. Para ello, anda a Manage models y renombra los que desees. Tambi√©n puedes eliminar los que ya no necesites.

Marca la opci√≥n de `Include sheet data` y dale al bot√≥n de **Understand**.

Se abrir√° una ventana con variada informaci√≥n.

![](understand1.jpg){fig-align="center" width="800"}

No todas las pesta√±as contienen informaci√≥n, pues depende del modelo que hayamos usado.

Veamos la **importancia de las variables.**

![](understand2.jpg){width="800"}

La importancia de las variables permite analizar qu√© tanto influye una variable (entiende eso como las columnas del set de datos) para predecir, en nuestro caso, la especie del ping√ºino.

F√≠jate en la √∫ltima secci√≥n: SUM_SCORE

    Variable Importance: SUM_SCORE:
        1. "bill_length_mm" 144.918849 ################
        2.         "island" 98.055598 ##########
        3.    "body_mass_g"  5.873762 

Para predecir la especie, el modelo usa principalmente esas 3 variables, pero fundamentalmente el largo de la aleta (`bill_length_mm`), pues obtiene un puntaje mayor. La isla tambi√©n parece ser importante para determinar la especie.

Si usas otros modelos, te van a aparecer muchas otras m√°s m√©tricas. Si quieres ver qu√© significan, puedes visitar su [documentaci√≥n oficial](https://ydf.readthedocs.io/en/latest/metrics.html).

La √∫ltima pesta√±a corresponde a un gr√°fico del modelo (plot).

![](understand3.jpg){width="800"}

Ok... no es el gr√°fico m√°s lindo del mundo jajajja üòÖ

Ya, pero lo que trata de mostrar el el camino que sigui√≥ para tomar la decisi√≥n de clasificaci√≥n de las especies. Son las reglas que se usaron, finalmente,

    Tree #0:
        "bill_length_mm">=43.15 [s:0.493991 n:281 np:152 miss:1] ; val:"Adelie" prob:[0.44484, 0.359431, 0.19573]
            ‚îú‚îÄ(pos)‚îÄ "island" is in [BITMAP] {Dream, Torgersen} [s:0.645103 n:152 np:57 miss:0] ; val:"Gentoo" prob:[0.0328947, 0.618421, 0.348684]
            |        ‚îú‚îÄ(pos)‚îÄ "bill_length_mm">=46.05 [s:0.107149 n:57 np:43 miss:0] ; val:"Chinstrap" prob:[0.0701754, 0, 0.929825]
            |        |        ‚îú‚îÄ(pos)‚îÄ val:"Chinstrap" prob:[0, 0, 1]
            |        |        ‚îî‚îÄ(neg)‚îÄ "body_mass_g">=3975 [s:0.419554 n:14 np:5 miss:1] ; val:"Chinstrap" prob:[0.285714, 0, 0.714286]
            |        |                 ‚îú‚îÄ(pos)‚îÄ val:"Adelie" prob:[0.8, 0, 0.2]
            |        |                 ‚îî‚îÄ(neg)‚îÄ val:"Chinstrap" prob:[0, 0, 1]
            |        ‚îî‚îÄ(neg)‚îÄ val:"Gentoo" prob:[0.0105263, 0.989474, 0]
            ‚îî‚îÄ(neg)‚îÄ val:"Adelie" prob:[0.930233, 0.0542636, 0.0155039]

¬øRecuerdas que era el largo de la aleta la variable m√°s importante?

Bueno, f√≠jate que ac√° est√° al inicio del √°rbol, pues es la que permite una mayor discriminaci√≥n de especies. Por ejemplo, si el largo de la aleta en menor de 43.14 mm con un 93% de probabilidades la especie es Adelie. Debes seguir el camino.

## Usemos el modelo

Hasta ahora todo bien. Pero una de las gracias es poder usar el modelo con nuevos datos y predecir, en este caso, la especie.

Ac√° es relevante que el modelo que usemos haya tenido buenos resultados y nos de cierta seguridad de que va a predecir bien.

En la plantilla, crea una nueva hoja en blanco y pone algunos datos de ping√ºinos en las variables, dejando el de la especie en blanco. Los datos te los puedes inventar siquieres, pero ten ojo con no poner cosas muy extra√±as, de lo contrario, los resultados ser√°n cualquier cosa, pues no son coherentes. O sea, poner un peso de 10.000 gramos es como extramo por ejemplo. Imagina que la idea de este ejemplo es que tienes datos de unos ping√ºinos y quieres saber su especie. Son datos que deben estar dentro de cierta l√≥gica.

Una vez que tengas los datos en la nueva hoja (aseg√∫rate que los nombres las columnas sean iguales a las originales), seleccionamos la opcion de `Make predictions with a model`:

![](predict4.jpg){fig-align="center" width="300"}

Luego, elegimos el modelo que usaremos para esas predicciones. Es el mismo que ten√≠amos antes o uno nuevo si es es que hiciste m√°s pruebas.

Dale al bot√≥n Predict.

Al igual que antes, se crear√°n 2 columnas, una con la especia predicha y otra con el porcentaje de confianza que hab√≠amos visto antes.

Estos son mis resultados:

![](dataset3.jpg){fig-align="center" width="800"}

Hay m√°s opciones como guardar el modelo para poder usarlo despu√©s o poder usar otros modelos de clasificaci√≥n como `Random Forest` o `Gradient Booted Trees`.

Prueba alguno de ellos y ve que te resulta.

## Conclusiones

La inteligencia artificial est√° cada d√≠a m√°s presente en nuestras vidas, aunque no nos demos cuenta. Por eso es importante entenderla.

Este tutorial busca acercar la IA a las personas que lo ven muy lejano o que no saben programar este tipo de cosas. Pero ojo, como te mencion√© antes, debe usarse con responsabilidad y sentido √©tico. Este ejmplo de los ping√ºinos es entretenido, pero otra cosa es clasificar a personas para decidir si van a recibir un beneficio social o si son atendidos en la urgencia. Ve este tutorial como lo que es, un ejemplo que de cada d√≠a la IA est√° m√°s cerca. Y que se nos abre todo un mundo por delante. Posiblemente en alg√∫n tiempo m√°s (no mucho) una de las competencias m√°s buscadas ser√° la de saber aplicar modelos de ML en distintas plataformas e integrarlas, m√°s que saber escribir c√≥digo propiamente tal. Eso si, demandar√° mayor niveles de conocimientos, manejo √©tico de datos y entender en profundidad los que estamos haciendo.

Ah!!! No te dije algo importante üòÅ

La primera parte de este art√≠culo fue escrita casi totalmente por **chatGPT**, una intelegiencia artificial que fue entrenada para mantener conversaciones naturales.
